<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mekanik Bus TP</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#d32f2f">

<style>
:root{--primary:#d32f2f;--success:#2e7d32;--bg:#f1f5f9}
*{box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{background:var(--bg);margin:0;padding:15px}
.container{max-width:500px;margin:auto;background:#fff;padding:20px;border-radius:12px}
h2{text-align:center;color:var(--primary)}
.tabs{display:flex;gap:5px;margin-bottom:15px}
.tab-btn{flex:1;padding:10px;border:none;border-radius:8px;font-weight:bold;background:#eee}
.tab-btn.active{background:var(--primary);color:#fff}
.content{display:none}
.content.active{display:block}
select,textarea,button{width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc}
.card{background:#fff;border:1px solid #ddd;padding:12px;border-radius:8px;margin-bottom:8px}
.btn{border:none;border-radius:6px;padding:6px 10px;font-weight:bold}
.done{background:#1976d2;color:#fff}
.save{background:var(--success);color:#fff}
.ok{color:green;font-weight:bold}
small{color:#777}
</style>
</head>

<body>
<div class="container">
<h2>üõ†Ô∏è Mekanik Bus TP</h2>

<div class="tabs">
<button class="tab-btn active" onclick="tab('list',this)">Daftar</button>
<button class="tab-btn" onclick="tab('input',this)">Input</button>
<button class="tab-btn" onclick="tab('history',this)">Riwayat</button>
</div>

<div id="list" class="content active"></div>

<div id="input" class="content">
<select id="bus">
<option>TP-A1-01</option><option>TP-A1-02</option>
<option>TP-A2-01</option><option>TP-B1-01</option>
</select>

<select id="job">
<option>Ganti Oli</option>
<option>Sistem Rem</option>
<option>Kelistrikan</option>
<option>Kaki-kaki</option>
<option>Mesin</option>
</select>

<textarea id="note" placeholder="Keterangan kerusakan..."></textarea>
<button class="btn save" onclick="simpan()">SIMPAN DATA</button>
</div>

<div id="history" class="content"></div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("mekanikTP")) || [];

function tab(id,btn){
 document.querySelectorAll('.content').forEach(c=>c.classList.remove('active'));
 document.getElementById(id).classList.add('active');
 document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
 btn.classList.add('active');
 render();
}

function simpan(){
 if(!bus.value || !job.value) return alert("Lengkapi data!");
 data.push({
  bus:bus.value,
  job:job.value,
  note:note.value,
  time:new Date().toLocaleString("id-ID"),
  status:"Aktif"
 });
 localStorage.setItem("mekanikTP",JSON.stringify(data));
 note.value="";
 render();
 tab('list',document.querySelectorAll('.tab-btn')[0]);
}

function selesai(i){
 if(confirm("Tandai selesai?")){
  data[i].status="Selesai";
  localStorage.setItem("mekanikTP",JSON.stringify(data));
  render();
 }
}

function render(){
 list.innerHTML="";
 history.innerHTML="";
 if(data.length===0){
  list.innerHTML="<p align='center'>Belum ada pekerjaan</p>";
  return;
 }
 data.forEach((d,i)=>{
  let card=`<div class="card">
   <b>${d.bus}</b><br>
   ${d.job}<br>
   <small>${d.note||'-'}</small><br>
   <small>${d.time}</small><br>`;
  if(d.status==="Aktif"){
   card+=`<button class="btn done" onclick="selesai(${i})">Selesai</button>`;
   list.innerHTML+=card+"</div>";
  }else{
   history.innerHTML+=card+`<span class="ok">‚úì OK</span></div>`;
  }
 });
}
render();

// Register Service Worker
if ('serviceWorker' in navigator) {
 navigator.serviceWorker.register('service-worker.js');
}
</script>
</body>
</html>