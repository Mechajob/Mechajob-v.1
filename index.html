<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mekanik Bus TP</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#d32f2f">

<style>
:root{--primary:#d32f2f;--success:#2e7d32;--bg:#f1f5f9}
*{box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{background:var(--bg);margin:0;padding:15px}
.container{max-width:500px;margin:auto;background:#fff;padding:20px;border-radius:12px}
h2{text-align:center;color:var(--primary)}
.tabs{display:flex;gap:5px;margin-bottom:15px}
.tab-btn{flex:1;padding:10px;border:none;border-radius:8px;font-weight:bold;background:#eee}
.tab-btn.active{background:var(--primary);color:#fff}
.content{display:none}
.content.active{display:block}
select,textarea,button{width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid #ccc}
.row{display:flex;gap:8px}
.card{background:#fff;border:1px solid #ddd;padding:12px;border-radius:8px;margin-bottom:8px}
.btn{border:none;border-radius:6px;padding:6px 10px;font-weight:bold}
.done{background:#1976d2;color:#fff}
.save{background:var(--success);color:#fff}
.ok{color:green;font-weight:bold}
small{color:#777}
</style>
</head>

<body>
<div class="container">
<h2>üõ†Ô∏è Mekanik Bus TP</h2>

<div class="tabs">
<button class="tab-btn active" onclick="tab('list',this)">Daftar</button>
<button class="tab-btn" onclick="tab('input',this)">Input</button>
<button class="tab-btn" onclick="tab('history',this)">Riwayat</button>
</div>

<div id="list" class="content active"></div>

<div id="input" class="content">

<label>Nomor Lambung</label>
<div class="row">
<select id="prefix">
<option>A1</option><option>A2</option><option>A3</option><option>A4</option>
<option>B1</option><option>B2</option><option>B3</option><option>B4</option>
<option>BS</option><option>CAD</option>
</select>

<select id="number">
<option>01</option><option>02</option><option>03</option><option>04</option><option>05</option>
<option>06</option><option>07</option><option>08</option><option>09</option><option>10</option>
</select>
</div>

<label>Jenis Pekerjaan</label>
<select id="job">
<option>Ganti Oli</option>
<option>Sistem Rem</option>
<option>Kelistrikan</option>
<option>Kaki-kaki</option>
<option>Mesin</option>
</select>

<label>Keterangan</label>
<textarea id="note" placeholder="Detail kerusakan..."></textarea>

<button class="btn save" onclick="simpan()">SIMPAN DATA</button>
</div>

<div id="history" class="content"></div>
</div>

<script>
let data = JSON.parse(localStorage.getItem("mekanikTP")) || [];

function tab(id,btn){
 document.querySelectorAll('.content').forEach(c=>c.classList.remove('active'));
 document.getElementById(id).classList.add('active');
 document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
 btn.classList.add('active');
 render();
}

function simpan(){
 const lambung = `TP-${prefix.value}-${number.value}`;
 data.push({
  lambung,
  job:job.value,
  note:note.value,
  time:new Date().toLocaleString("id-ID"),
  status:"Aktif"
 });
 localStorage.setItem("mekanikTP",JSON.stringify(data));
 note.value="";
 render();
 tab('list',document.querySelectorAll('.tab-btn')[0]);
}

function selesai(i){
 if(confirm("Tandai bus selesai diperbaiki?")){
  data[i].status="Selesai";
  localStorage.setItem("mekanikTP",JSON.stringify(data));
  render();
 }
}

function render(){
 list.innerHTML="";
 history.innerHTML="";

 let adaAktif = false;
 let adaRiwayat = false;

 data.forEach((d,i)=>{
  let card = `<div class="card">
    <b>${d.lambung}</b><br>
    ${d.job}<br>
    <small>${d.note || '-'}</small><br>
    <small>${d.time}</small><br>`;

  if(d.status === "Aktif"){
    adaAktif = true;
    card += `<button class="btn done" onclick="selesai(${i})">Selesai</button>`;
    list.innerHTML += card + `</div>`;
  } else {
    adaRiwayat = true;
    history.innerHTML += card + `<span class="ok">‚úì OK</span></div>`;
  }
 });

 if(!adaAktif){
  list.innerHTML = "<p align='center'>Tidak ada pekerjaan aktif</p>";
 }

 if(!adaRiwayat){
  history.innerHTML = "<p align='center'>Belum ada riwayat</p>";
 }
}

render();

// PWA
if ('serviceWorker' in navigator) {
 navigator.serviceWorker.register('service-worker.js');
}
</script>
</body>
</html> 